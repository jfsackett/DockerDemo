plugins {
	id 'java-library'
    id 'eclipse'
    id 'com.palantir.docker' version '0.22.2'
}

repositories {
    mavenCentral()
}

defaultTasks 'clean', 'docker'

jar {
    zip64 true
    archiveFileName = "docker-java.jar"
    manifest {
        attributes(
            'Main-Class': 'demo.HelloArgs'
        )
    }
}

docker {
    name 'docker-java:1'
    dockerfile file('Dockerfile')
    files tasks.jar.outputs, 'README.md'
    copySpec.into("./image-files")
    dependsOn tasks.jar
}

task cleanDockerOrphans(type:Exec) {
  commandLine './rm-orphans.sh'
}
